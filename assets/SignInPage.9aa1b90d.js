import{by as g,bD as C,bz as m,bX as F,bW as w,bE as e,bO as p}from"./vendor.619c3c28.js";import{M as x}from"./MainLayout.9e39ae53.js";import{B as I}from"./BackIcon.d9e77359.js";import{I as N,B as j}from"./Icon.583548dc.js";import{F as D,a as i}from"./Form.10ce202f.js";import{u as M,h as f}from"./index.63fb4255.js";import{v as O,h as q}from"./validate.f13e3d9d.js";import"./vant.8c46507c.js";const E=u=>{const t=g(u);return{ref:t,toggle:()=>t.value=!t.value,on:()=>t.value=!0,off:()=>t.value=!1}},L="_logo_ly99d_1",T="_icon_ly99d_8",A="_appName_ly99d_12";var n={logo:L,icon:T,appName:A};const K=C({setup:(u,t)=>{const b=M(),a=m({email:"sk@sk.com",code:"123456"}),s=m({email:[],code:[]}),c=g(),{ref:y,toggle:R,on:v,off:_}=E(!1),h=F(),k=w(),B=async o=>{var l;if(o.preventDefault(),Object.assign(s,{email:[],code:[]}),Object.assign(s,O(a,[{key:"email",type:"required",message:"\u5FC5\u586B"},{key:"email",type:"pattern",regex:/.+@.+/,message:"\u5FC5\u987B\u662F\u90AE\u7BB1\u5730\u5740"},{key:"code",type:"required",message:"\u5FC5\u586B"}])),!q(s)){const r=await f.post("/session",a,{_autoLoading:!0}).catch(d);localStorage.setItem("jwt",r.data.jwt);const V=(l=k.query.return_to)==null?void 0:l.toString();b.refreshMe(),h.push(V||"/")}},d=o=>{throw o.response.status===422&&Object.assign(s,o.response.data.errors),o},S=async()=>{v(),await f.post("/validation_codes",{email:a.email},{_autoLoading:!0}).catch(d).finally(_),c.value.startCount()};return()=>e(x,null,{title:()=>"\u767B\u5F55",icon:()=>e(I,null,null),default:()=>e("div",{class:n.wrapper},[e("div",{class:n.logo},[e(N,{class:n.icon,name:"pig"},null),e("h1",{class:n.appName},[p("\u65F6\u7A7A\u5B58\u94B1\u7F50")])]),e(D,{onSubmit:B},{default:()=>{var o,l;return[e(i,{label:"\u90AE\u7BB1\u5730\u5740(\u6D4B\u8BD5\u90AE\u7BB1\uFF1Ask@sk.com)",type:"text",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\uFF0C\u7136\u540E\u70B9\u51FB\u53D1\u9001\u9A8C\u8BC1\u7801",modelValue:a.email,"onUpdate:modelValue":r=>a.email=r,error:(o=s.email)==null?void 0:o[0]},null),e(i,{ref:c,label:"\u9A8C\u8BC1\u7801(\u6D4B\u8BD5\u9A8C\u8BC1\u7801\uFF1A123456)",type:"validationCode",placeholder:"\u8BF7\u8F93\u5165\u516D\u4F4D\u6570\u5B57",countFrom:60,disabled:y.value,onClick:S,modelValue:a.code,"onUpdate:modelValue":r=>a.code=r,error:(l=s.code)==null?void 0:l[0]},null),e(i,{style:{paddingTop:"96px"}},{default:()=>[e(j,{type:"submit"},{default:()=>[p("\u767B\u5F55")]})]})]}})])})}});export{K as SignInPage,K as default};
